function GraphicComponent(){!function(e){configura(null).init(),e.tipo=null,e.modified="06-10-2022",e.penultimo_cambio="1 - Se integra el llamado EquivalenciaIndicadorBIE_BISE para  API v1_3 y tematica = 3, permite determinar a que tematica pertenecen los indicadores en cuestión",e.ultimo_cambio="2 - Modificaciones para agregar multiple area geografica para todos los tipos de orientacion [10-10-2022]",e.token="fb6730a1-d0c7-ebe9-65d1-d3dbb8d93457",e.datosOriginales=null,e.datosMostrar=null,e.datosNotasFuentes=null,this.config={},e.aIndicadores=[],e.sinDatos=!1,e.enableDataLabels=!0,e.localhost=document.location.host.indexOf("localhost")>-1||document.location.host.indexOf("127.0.0.1")>-1,e.periodosSelected=[],e.indicadoresSelected=[],e.indicadoresIdSelected=[],e.areasSelected=[],e.colors=["#006064","#80cbc4","#73B281","#FA854B","#008D8B","#f06292","#aed581","#ffd54f","#6ACCAE","#E88A80","#B26160","#C9B4FF","#70B28D","#95B279","#7FF8FF","#B4FFCA","#E8D957","#E8B1DD","#FF192F","#97B27E","#30B2A1","#FF7C43","#FFED34","#FFB843","#B23034","#CB6168","#80cbc4","#73B281","#FA854B","#6ACCAE","#E88A80","#B26160"],e.divGrafica=null,e.tplLoading='<div class="modal modalReloj fade" id="loadingGraficador" tabindex="-1" role="dialog" aria-hidden="true"><img alt="Cargando información..." class="centerme" title="Cargando información..." src="/img/cargando.gif" /></div>',e.nombre_indicador="",e.divNotasFuentes=null,e.chartConfigCurrent={},e.ul=document.createElement("ul"),e.ul.style.listStyle="none",e.ul.style.padding="0",e.ul.style.margin="0",e.idioma=window.location.hostname.indexOf("en.")>-1?"en":"es",e.preconfigHighcharts=function(){Highcharts.setOptions({exporting:{enabled:!1,chartOptions:{legend:{labelFormatter:function(){var e=this.name;return this.name.indexOf(">")>-1&&(e=this.name.split(">")[this.name.split(">").length-1]),e.length>50?[...e].splice(0,80).join("")+"...":e},layout:"horizontal",enabled:!0,allowHTML:!0,itemStyle:{fontFamily:"Arial",fontWeight:"normal",fontSize:"7px",textDecoration:"none"},itemWidth:300,lineHeight:17,navigation:{enabled:!1},align:"center"},allowHTML:!0,plotOptions:{series:{dataLabels:{enabled:!1}}}},sourceWidth:800,sourceHeight:600,fallbackToExportServer:!1},lang:{resetZoom:"Restablecer Zoom",noData:"Sin datos para mostrar",thousandsSep:",",numericSymbols:null}})},e.loadConfig=function(){"function"==typeof Mura&&void 0!==Mura?Mura.loader().loadjs("/componentes/biinegi/config.min.js",function(){configura().init(),e.loadResources()}):(configura().init(),e.loadResources())},e.loadResources=function(){if("function"==typeof Mura&&void 0!==Mura){var t=document.scripts,i=!1;for(s in t)if(t[s].src&&t[s].src.indexOf("highcharts")>-1){i=!0;break}0==i?(m.loader().loadjs(C_dominioBuscador+"componentes/biinegi/highcharts.js",function(){setTimeout(function(){e.preconfigHighcharts()},2e3)}),m.loader().loadcss(C_dominioBuscador+"app/indicadores/graficador/graficador.indicadores.bie.min.css",{media:"all"})):(Mura.loader().loadcss(C_dominioBuscador+"app/indicadores/graficador/graficador.indicadores.bie.min.css",{media:"all"}),e.preconfigHighcharts())}else setTimeout(function(){console.info("-No se encontro el archivo preloader.js, carga normal "),e.preconfigHighcharts()},200)},e.loadConfig()}(this),this.getData=function(){return this.datosEstructurados},this.getConfig=function(){return this.config},this.getInstance=function(){return this.chart},this.reset=function(){$("#"+this.config.id).empty(""),$("#"+this.config.toolbar).empty("")},this.selectionChart=function(e){switch(this.tipo=void 0===e?this.tipo:e,this.createContainerHtml(),this.renderFiltros(),this.tipo){case"line":case"area":case"bar":case"column":this.renderGroupChart();break;case"pie":this.renderPie()}},this.createContainerHtml=function(){if($("#divGrafica_"+this.config.id).remove(),divGrafica=document.createElement("div"),divGrafica.id=this.divGrafica="divGrafica_"+this.config.id,divGrafica.className="graficador-componente",$(this.divNotasFuentes).remove(),this.divNotasFuente=null,this.divNotasFuentes=document.createElement("div"),this.divNotasFuentes.id="divGraphicNotasFuentes_"+this.config.id,this.divNotasFuentes.style="overflow:hidden;",null===document.getElementById(this.config.id))throw"El contendor "+this.config.id+" No existe";document.getElementById(this.config.id).appendChild(divGrafica),document.getElementById(this.config.id).appendChild(this.divNotasFuentes)},this.renderGroupChart=function(){var e=this,t=this.datosMostrar,i=this.periodosSelected,a=this.areasSelected,n=e.indicadoresSelected,o=(this.indicadoresIdSelected,this.config._indicadores),r=(this.config._periodos,this.config._areaGeografica),s=this.config._orientacion,c=[],d=[],l=[];if(!1===e.sinDatos)if(o.length>=1&&r.length>=1&&("indicadorHorizontal"==s||"indicadorVertical"==s)){var h=this.arrColoresSelected.filter(function(t){return t.p===e.periodosSelected[0]});c=[],d=[];$.each(t,function(t,i){var a=0;0==t?$.each(i.listaCeldas,function(t,i){var a={name:"",data:[]};t>0&&(a.name=i.valor,a.color=0==h.length?e.colors[t-1]:h[0].color,d.push(a))}):$.each(i.listaCeldas,function(t,i){if(t>0){var n=e.checkValue(i.valor);d[a].data.push(n),a++}else{var o=e.getLastNameIndicador(i.valor);c.push(o)}})})}else if(o.length>1&&1==r.length&&"indicadorVertical"==s){c=[],d=[];if($.each(t,function(t,i){var a=0;0==t?$.each(i.listaCeldas,function(t,i){var a={name:"",data:[]};t>0&&(a.name=i.valor,a.color=e.colors[t-1],d.push(a))}):$.each(i.listaCeldas,function(t,i){if(t>0){var n=e.checkValue(i.valor);l.push(n),d[a].data.push(n),a++}else c.push(i.valor)})}),n.length>0){var p=[],u=[];$.each(d,function(t,i){e.indicadoresNameSelected.indexOf(i.name)>-1?p.push(i):u.push(t)}),d=p,p=[]}if(l.length>0&&l.every(function(e,t,i){return null===e}))return void this.showMessageInvalidValues("El periodo seleccionado no cuenta con un dato numérico, le recomendamos seleccionar otro diferente.")}else if(o.length>=1&&r.length>=1&&"areaHorizontal"==s){h=this.arrColoresSelected.filter(function(t){return t.p===e.periodosSelected[0]}),c=[],d=[];if($.each(t,function(t,i){var a=0;0==t?$.each(i.listaCeldas,function(t,i){var a={name:"",data:[]};t>0&&(a.name=i.valor,a.color=0==h.length?e.colors[t-1]:h[0].color,d.push(a))}):$.each(i.listaCeldas,function(t,i){if(t>0){var n=e.checkValue(i.valor);l.push(n),d[a].data.push(n),a++}else c.push(i.valor)})}),i.length>0){p=[];$.each(d,function(e,t){-1!==i.indexOf(t.name)&&p.push(t)}),d=p,p=[]}if(a.length>0){for(var f=[],m=[],g=0;g<c.length;g++){var v=c[g];0==a.filter(function(e,t){var i=e.substring(0,e.indexOf(" ")-1);return v.indexOf(i)>-1}).length?m.push(g):f.push(v)}c=f,$.each(d,function(e,t){for(var i=m.length-1;i>=0;i--)d[e].data.splice(m[i],1)})}if(l.length>0&&l.every(function(e,t,i){return null===e}))return void this.showMessageInvalidValues("El periodo seleccionado no cuenta con un dato numérico, le recomendamos seleccionar otro diferente.")}else if(o.length>0&&r.length>0&&"areaVertical"==s){c=[],d=[];if($.each(t,function(t,i){var a=0;0==t?$.each(i.listaCeldas,function(t,i){var a={name:"",data:[]};t>0&&(a.name=i.valor,a.color=e.colors[t-1],d.push(a))}):$.each(i.listaCeldas,function(t,i){if(t>0){var n=e.checkValue(i.valor);d[a].data.push(n),a++}else c.push(i.valor)})}),i.length>0){f=[],u=[];$.each(c,function(e,t){-1!==i.indexOf(t)?f.push(t):u.push(e)}),c=f,f=[],$.each(d,function(e,t){for(var i=u.length-1;i>=0;i--)d[e].data.splice(u[i],1)})}if(a.length>0){p=[],u=[];$.each(d,function(e,t){-1!==a.indexOf(t.name)?p.push(t):u.push(e)}),d=p,p=[]}}var b={gTitulo:"",gSubtitulo:"",aSeries:d,aCategorias:c};this.renderChart(b)},this.showMessageInvalidValues=function(e){$("#"+this.divGrafica).html('<div class="alert alert-warning" role="alert">'+e+"</div>"),this.loading(!1)},this.renderPie=function(){var e=this,t=this.datosOriginales,i="",a=this.config._indicadores,n=(this.config._periodos,this.config._areaGeografica),o=this.config._orientacion;if(a.length>0&&1==n.length&&"indicadorHorizontal"==o){var r=[],s=[];if($.each(t,function(e,t){0==e&&$.each(t.listaCeldas,function(e,t){var i={},a={};e>0&&(i.name=i.drilldown=t.valor,a.name=a.id=t.valor,s.push(i),r.push(a))})}),$.each(s,function(i,a){var n=0;$.each(t,function(t,a){t>0&&($.each(a.listaCeldas,function(t,a){if(t>0&&i+1==t){var o=e.checkValue(a.valor);n+=o}}),s[i].y=n)})}),$.each(r,function(e,i){i.data=[],$.each(t,function(e,t){if(e>0){var a=[];$.each(t.listaCeldas,function(e,t){0==e&&a.push(t.valor)}),i.data.push(a)}})}),$.each(r,function(i,a){var n=0;$.each(t,function(t,o){if(t>0){var r=o.listaCeldas[i+1].valor;r=e.checkValue(r);a.data[n].push(r),n++}})}),s=[{name:"Periodos",colorByPoint:!0,data:s}],d={series:r},2==t.length)i=c=t[1].listaCeldas[0].valor.indexOf(">")?t[1].listaCeldas[0].valor.split(">")[t[1].listaCeldas[0].valor.split(">").length-1]:t[1].listaCeldas[0].valor}else if(a.length>0&&1==n.length&&"indicadorVertical"==o){r=[],s=[];if($.each(t,function(e,t){0==e&&$.each(t.listaCeldas,function(e,t){var i={},a={};e>0&&(i.name=i.drilldown=t.valor,a.name=a.id=t.valor,s.push(i),r.push(a))})}),$.each(s,function(i,a){var n=0;$.each(t,function(t,a){t>0&&($.each(a.listaCeldas,function(t,a){if(t>0&&i+1==t){var o=e.checkValue(a.valor);n+=o}}),s[i].y=n)})}),$.each(r,function(e,i){i.data=[],$.each(t,function(e,t){if(e>0){var a=[];$.each(t.listaCeldas,function(e,t){0==e&&a.push(t.valor)}),i.data.push(a)}})}),$.each(r,function(i,a){var n=0;$.each(t,function(t,o){if(t>0){var r=o.listaCeldas[i+1].valor;r=e.checkValue(r),a.data[n].push(r),n++}})}),s=[{name:"Indicadores",colorByPoint:!0,data:s}],d={series:r},2==t[0].listaCeldas.length){var c=t[0].listaCeldas[1].valor.indexOf(">")?t[0].listaCeldas[1].valor.split(">")[t[0].listaCeldas[1].valor.split(">").length-1]:t[0].listaCeldas[1].valor;nombre_indicador=c}}else if(1==a.length&&n.length>0&&"areaHorizontal"==o){r=[],s=[];$.each(t,function(e,t){0==e&&$.each(t.listaCeldas,function(e,t){var i={},a={};e>0&&(i.name=i.drilldown=t.valor,a.name=a.id=t.valor,s.push(i),r.push(a))})}),$.each(s,function(i,a){var n=0;$.each(t,function(t,a){t>0&&($.each(a.listaCeldas,function(t,a){if(t>0&&i+1==t){var o=e.checkValue(a.valor);n+=o}}),s[i].y=n)})}),$.each(r,function(e,i){i.data=[],$.each(t,function(e,t){if(e>0){var a=[];$.each(t.listaCeldas,function(e,t){0==e&&a.push(t.valor)}),i.data.push(a)}})}),$.each(r,function(i,a){var n=0;$.each(t,function(t,o){if(t>0){var r=o.listaCeldas[i+1].valor;r=e.checkValue(r),a.data[n].push(r),n++}})}),s=[{name:"Periodos",colorByPoint:!0,data:s}],d={series:r}}else if(1==a.length&&n.length>0&&"areaVertical"==o){var d=[];r=[],s=[];$.each(t,function(e,t){0==e&&$.each(t.listaCeldas,function(e,t){var i={},a={};e>0&&(i.name=i.drilldown=t.valor,a.name=a.id=t.valor,s.push(i),r.push(a))})}),$.each(s,function(i,a){var n=0;$.each(t,function(t,a){t>0&&($.each(a.listaCeldas,function(t,a){if(t>0&&i+1==t){var o=e.checkValue(a.valor);n+=o}}),s[i].y=n)})}),$.each(r,function(e,i){i.data=[],$.each(t,function(e,t){if(e>0){var a=[];$.each(t.listaCeldas,function(e,t){0==e&&a.push(t.valor)}),i.data.push(a)}})}),$.each(r,function(i,a){var n=0;$.each(t,function(t,o){if(t>0){var r=o.listaCeldas[i+1].valor;r=e.checkValue(r),a.data[n].push(r),n++}})}),s=[{name:"Indicadores",colorByPoint:!0,data:s}],d={series:r}}var l={gTitulo:i,gSubtitulo:"",aSeries:s,aCategorias:d};this.renderChart(l)},this.getFormatTooltip=function(e){var t="",i="",a=0;switch(this.config._orientacion){case"areaVertical":t=e.x,i=e.series.name,a=e.y;break;case"areaHorizontal":t=e.series.name,i=e.x,a=e.y;break;case"indicadorVertical":t=e.x,i=e.series.name,a=e.y;break;case"indicadorHorizontal":t=e.series.name,i=e.x,a=e.y}return{head:t,title:i,value:a}},this.renderChart=function(e){var t=this,i=this.aSeries=e.aSeries,a=this.aCategorias=e.aCategorias,n={};if("linea"!==this.tipo&&(n.chart={type:this.tipo,inverted:!1,polar:!1}),"pie"===this.tipo?n.drilldown=a:n.xAxis={categories:a,crosshair:!1},n.credits=!1,n.series=i,n.tooltip={enabled:!0,shadow:!1,backgroundColor:"#ffffff",useHTML:!0,followPointer:!0,style:{whiteSpace:"normal"},formatter:function(){var e=t.getFormatTooltip(this),i=t.datosNotasFuentes,a=e.title.indexOf(">")>-1?e.title.split(">"):e.title;if(Array.isArray(a)){for(var n="",o=0;o<a.length;o++){var r="";switch(o){case 0:r="";break;case 1:r="&ensp;&ensp;";break;case 2:r="&ensp;&ensp;&ensp;&ensp;";break;case 3:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 4:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 5:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 6:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 7:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 8:r="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;";break;case 9:xxxxxx="&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;"}n=r,a[o]=r+""+a[o]}if(textShow=a.join("><br />"),i.length>0){var s=i.filter(function(t){return"Cifras preliminares"==t.tipo&&t.periodos==e.head});s.length>0&&(e.head+=' <b style="color:#4a4a4a;">'+s[0].letra+"</b>")}}else textShow=a;n=null==n?"":n;var c=e.value.toString().indexOf(".")>-1?e.value.toString().split(".")[1].length:0;return'<div><b style="font-weight:bold;color:'+this.series.color+'">'+e.head+'</b><br /><div style="color:#4a4a4a">'+textShow+": </div>"+n+"<b>"+Highcharts.numberFormat(e.value,c,".")+"</b></div>"}},n.xAxis=$.extend(n.xAxis,{title:{text:this.config.hasOwnProperty("titulo_eje_x")?this.config.titulo_eje_x:""}}),n.yAxis={title:{text:this.config.hasOwnProperty("titulo_eje_y")?this.config.titulo_eje_y:""}},n.title={text:""},n.plotOptions={},this.config.hasOwnProperty("leyenda"))if("pie"!==this.tipo){var o={};switch(this.config.leyenda){case"top":o={layout:"vertical",align:"center",verticalAlign:"top",margin:20};break;case"left":o={layout:"vertical",align:"left",verticalAlign:"middle"};break;case"right":o={layout:"vertical",align:"right",verticalAlign:"middle"};break;case"bottom":o={layout:"vertical",align:"center",verticalAlign:"bottom"};break;case!1:o={enabled:!1,layout:"vertical",align:"center",verticalAlign:"bottom"}}o.useHTML=!0,o.itemWidth=window.innerWidth<400?380:window.innerWidth>350&&window.innerWidth<850?650:window.innerWidth>850?700:window.innerWidth-200,o.itemStyle={fontSize:"11px",textOverflow:"wrap"},o.labelFormatter=function(){var e=this.name.indexOf(">")>-1?this.name.split(">")[this.name.split(">").length-1]:this.name,t="",i=this.name.indexOf(">")>-1?this.name.split(">"):this.name;if(Array.isArray(i)){t=i.join(">")}else t=i;return'<a href="javascript:void(0)" title="'+t+'" style="color:#4a4a4a;">'+e+"</a>"},n.legend=!!this.config.leyenda&&o}else n.plotOptions={pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:this.config.leyenda},column:{dataLabels:{enabled:this.enableDataLabels}}};else n.plotOptions={pie:{dataLabels:{enabled:!1},showInLegend:!1}};n.plotOptions.series={connectNulls:!0,dataLabels:{enabled:this.enableDataLabels,formatter:function(){var e=this.y.toString().indexOf(".")>-1?this.y.toString().split(".")[1].length:0;return'<i style="font-size:9px;font-weight:normal;color:#4a4a4a;font-style:normal;">'+Highcharts.numberFormat(this.y,e)+"</i>"}},animation:{duration:500}},n.chart.zoomType="xy",n.chart.height="75%",window.innerWidth<500&&(n.legend.enabled=!1,n.chart.height="90%");t=this;n.colors=this.config.hasOwnProperty("colors")?this.config.colors:this.colors,void 0!==n.xAxis.categories?(n.chart.events={load:function(){if(t.loading(!1),t.sinDatos){var e="en"===t.idioma?"Not data to display":"No hay datos para mostrar";$("#divGrafica_"+t.config.id).html('<div class="alert alert-warning" role="alert">'+e+".</div>"),t.sinDatos=!1}else t.renderNotasFuentes()}},this.chartConfigCurrent=n,this.chart=Highcharts.chart(this.divGrafica,n)):($("#"+this.divGrafica).html('<div class="alert alert-warning" role="alert">Sin datos para mostrar con los parámetros actuales.</div>'),t.loading(!1))},this.arrIndicadoresLabel=[],this.arrColoresSelected=[],this.changedPeriodo=!1,this.changedArea=!1,this._addComboPeriodos=function(e){var t=this;if(this.config._periodos.length>=1){var i=new Array;if(0==$(document.getElementsByClassName("clsComboPeriodos_"+this.config.id)).children().length){var a=this.config._periodos,n=document.createElement("div");n.className="col-md-12 container-fluid clsComboPeriodos_"+t.config.id,n.style.marginBottom="10px";var o=document.createElement("label");o.innerHTML="es"===this.idioma?"Periodo:":"Period:",o.style="cursor:pointer;";var r=document.createElement("label");r.innerHTML="es"===this.idioma?"Periodo desde:":"Period from:",r.style="cursor:pointer;";var s=document.createElement("label");s.innerHTML="es"===this.idioma?"Hasta:":"To:",s.style="cursor:pointer;";var c=document.createElement("div");if(c.id="divAreaOpcionesPeriodos"+t.config.id,c.className=-1===this.config._orientacion.indexOf("Vertical")?"row-fluid":"row",-1!==t.config._orientacion.indexOf("Horizontal")){n.appendChild(o),c.style="background:#fff;display:block;",r.addEventListener("click",function(){$(c).slideToggle("fast")});var d=document.createElement("div");d.className="btn-group",d.setAttribute("data-toggle","buttons"),d.style="display:block;";var l=0;$.each(a,function(e,n){if(n>=parseInt(a[0])&&n<=parseInt(a[a.length-1])){var o=document.createElement("label");o.className="btn btn-default",0===e&&(o.className=o.className+" active"),o.style="border-radius:0px !important;border-bottom:4px solid"+t.colors[l]+" !important;width:auto",i[l]={p:n,color:t.colors[e]};var r=document.createElement("input");r.type="radio",r.name="periodo_"+t.config.id,r.id=n,r.autocomplete="off",0==e&&r.setAttribute("checked","checked"),o.innerHTML=n,$(o).append(r),$(d).append(o),$(c).append(d),$(r).change(function(){t.changedPeriodo=!0,t._filtro_LlenaArrayFiltros()}),l++}}),this.arrColoresSelected=i}else{l=0;var h=document.createElement("select");h.id="periodoMin_"+t.config.id,h.className="form-control";var p=document.createElement("div");p.className="col-md-6",p.style="margin-bottom:6px;";var u=document.createElement("select");u.id="periodoMax_"+t.config.id,u.className="form-control";var f=document.createElement("div");f.className="col-md-6",f.style="margin-bottom:6px;",$.each(a,function(e,t){if(t<=parseInt(a[0])&&t>=parseInt(a[a.length-1])){var i=document.createElement("option");i.value=t,i.text=t,h.appendChild(i);var n=document.createElement("option");n.value=t,n.text=t,u.appendChild(n),l++}}),$(h).change(function(){$(u).val()>=$(this).val()?(t.changedPeriodo=!0,t._filtro_LlenaArrayFiltros()):$(h).val($(u).val())}),$(u).change(function(){$(h).val()<=$(this).val()?(t.changedPeriodo=!0,t._filtro_LlenaArrayFiltros()):$(u).val($(h).val())}),h.selectedIndex=a.length-1,u.selectedIndex=0,$(p).append(r,h),$(f).append(s,u),$(c).append(p,f)}$(n).append(c),$(e).find(".navbar").append(n)}}else t._filtro_LlenaArrayFiltros()},this.changeIndicador=!1,this.checkboxIndicadorRestante=[],this._filtro_LlenaArrayFiltros=function(){var e,t=this;if(this.periodosSelected=[],-1!==this.config._orientacion.indexOf("Horizontal")){var i=$("input[name=periodo_"+this.config.id+"]");this.periodosSelected=[],$.each(i,function(e,i){$(i).is(":checked")&&t.periodosSelected.push($(i).attr("id"))})}else{var a=$("#periodoMin_"+this.config.id).val(),n=$("#periodoMax_"+this.config.id).val(),o=parseInt(this.config._periodos[0])>parseInt(this.config._periodos[this.config._periodos.length-1])?this.config._periodos.reverse():this.config._periodos;$.each(o,function(e,i){parseInt(i)>=parseInt(a)&&parseInt(i)<=parseInt(n)&&t.periodosSelected.push(parseInt(i))})}if(this.indicadoresSelected=[],this.indicadoresIdSelected=[],this.indicadoresNameSelected=[],"indicadorVertical"===this.config._orientacion||"areaVertical"===this.config._orientacion||"areaHorizontal"===this.config._orientacion){if(c=$("input[name=indicador_"+this.config.id+"]"),1===(e=$("input[name=indicador_"+this.config.id+"]:checked")).length&&(this.checkboxIndicadorRestante=$(e)),1===this.checkboxIndicadorRestante.length&&0===e.length){var r=$(this.checkboxIndicadorRestante).attr("id");return document.getElementById(r).checked=!0,void alert("es"==this.idioma?"No puede haber indicadores sin seleccionar":"You must select at least one indicator")}$.each(c,function(e,i){$(i).is(":checked")&&(t.indicadoresSelected.push($(i).attr("id")),t.indicadoresIdSelected.push($(i).attr("data-value")),t.indicadoresNameSelected.push($(i).attr("data-value-name")))});var s="";s="radio"===$(this.checkboxIndicadorRestante).attr("type")?this.indicadoresNameSelected||"-":"es"===this.idioma?this.indicadoresSelected.length+" Indicadores seleccionados ":this.indicadoresSelected.length+" Selected indicators ",$("#_cbxIndicadores"+t.config.id).find(".textIndicador").html(s),$("#_cbxIndicadores"+t.config.id).dropdown()}else{var c=$("input[name=indicador_"+this.config.id+"]"),d=!0;if($.each(c,function(e,i){$(i).is(":checked")&&(1==d&&(d=!1),t.indicadoresSelected.push($(i).attr("id")),t.indicadoresIdSelected.push($(i).attr("data-value")),t.nombre_indicador=$(i).attr("id"),$("#_cbxIndicadores"+t.config.id).find(".textIndicador").html($(i)[0].id+" ("+$(i).attr("data-value")+")"))}),d&&void 0!==$(c)[0]){var l=$(c)[0].id;t.indicadoresSelected.push(l),$("#_cbxIndicadores"+t.config.id).find(".textIndicador").html(l+" ")}}var h=$("input[name=area_"+this.config.id+"]");this.areasSelected=[],$.each(h,function(e,i){$(i).prop("checked")&&t.areasSelected.push($(i).attr("id"))});var p="es"===this.idioma?this.areasSelected.length+" áreas seleccionadas ":this.areasSelected.length+" selected areas ";$("#_cbxAreasGeograficas"+t.config.id).find(".textArea").html(p),(t.changeIndicador||t.changedPeriodo||t.changedArea)&&(t.callService(),t.changeIndicador=!1,t.changedPeriodo=!1,t.changedArea=!1)},this.arrColoresSelectedIndicador=[],this._addComboIndicadoresAreas=function(e){var t=new Array,i=this,a=null;if("indicadorHorizontal"===i.config._orientacion&&!1===this.sinDatos){if(0==$(document.getElementById("clsComboIndicadores_"+this.config.id)).children().length){(a=document.createElement("div")).className="col-xs-12 col-sm-6 col-md-6 container-fluid cb-standar",a.id="clsComboIndicadores_"+this.config.id,(l=document.createElement("div")).className="dropdown";var n=document.createElement("button");n.type="button",n.className="btn btn-default dropdown-toggle col-xs-12 col-sm-12 col-md-12",n.setAttribute("data-toggle","dropdown"),n.setAttribute("aria-haspopup","true"),n.id="_cbxIndicadores"+this.config.id,n.innerHTML="",n.style="text-align:left;";var o=document.createElement("span");o.className="caret",(p=document.createElement("ul")).className="dropdown-menu",p.style="max-height:500px;overflow:auto;";var r=null;(w=document.createElement("label")).innerHTML=" Indicador: ";this.datosOriginales;var s=[];$.each(this.config._areaGeografica,function(e,t){s.push(t.id)});var c="",d="";"v1_2"==API_V?c=null!=this.config._tematica&&""!=this.config._tematica?this.config._tematica+"/":"null/":"v1_1"==API_V||(c=""!=this.config._tematica?this.config._tematica+"/":"null/");d=this.urlApi()+"/ValorIndicador/"+this.config._indicadores.join(",")+"/"+s.join()+"/null/es/null/null/3/null/null/0/"+this.config._periodos[0]+"/"+this.config._periodos[this.config._periodos.length-1]+"/null/"+c+"json/"+this.token+"?callback=?";$.getJSON(d,null,function(s){var c=i.arrIndicadoresLabel=s.dimension.indicator.category.label,d=0;$.each(c,function(e,a){var n=document.createElement("label"),o=document.createElement("div");-1!==i.config._orientacion.indexOf("Vertical")&&"areaVertical"!==i.config._orientacion&&(t[d]={i:a.Value,color:i.colors[e]},o.style="display: inline-block;margin-right: 5px;width:15px;height:16px;background-color:"+i.colors[e],d++);var s=document.createElement("input"),c="radio";i.config._indicadores.length>1&&i.config._areaGeografica.length>=1?(s.type="checkbox",s.setAttribute("checked","checked"),c="checkbox"):(s.type="radio",0===e&&(s.setAttribute("checked","checked"),n.className=n.className+" active")),s.name="indicador_"+i.config.id,s.id=a.Value,s.autocomplete="off",s.setAttribute("data-value",a.Key.split("_")[1]),s.className=s.className+" cls-input-graf";var l="";l=-1!=a.Value.indexOf(">")?(l=a.Value.split(">"))[l.length-1]:a.Value,$(n).append(s,o,$("<span>"+l+"</span>")),(r=document.createElement("li")).className=c,$(r).append(n),$(p).append(r),$(s).change(function(){i.changeIndicador=!0,i._filtro_LlenaArrayFiltros()})}),i.arrColoresSelectedIndicador=t;var h=document.createElement("span");h.className="textIndicador trunca",$(n).append(h,o),$(l).append(n,p),$(a).append(w,l),$(e).find(".navbar").append(a),0===i.indicadoresSelected.length&&i._filtro_LlenaArrayFiltros()})}}else if(("indicadorVertical"===i.config._orientacion||"areaVertical"===i.config._orientacion||"areaHorizontal"===i.config._orientacion)&&this.config._indicadores.length>1){if(0==$(document.getElementsByClassName("clsComboIndicadores_"+this.config.id)).children().length){var l,h=document.createElement("div");h.className="col-xs-12 col-sm-6 col-md-6 container-fluid cb-standar clsComboIndicadores_"+this.config.id,(l=document.createElement("div")).className="dropdown";var p,u=document.createElement("button");u.type="button",u.className="btn btn-default dropdown-toggle col-xs-12 col-sm-12 col-md-12",u.setAttribute("data-toggle","dropdown"),u.setAttribute("aria-haspopup","true"),u.innerHTML="",u.id="_cbxIndicadores"+this.config.id,u.style="text-align:left;",(k=document.createElement("span")).className="caret",(p=document.createElement("ul")).className="dropdown-menu",p.style="max-height:500px;overflow:auto;";var f=null;this.config._indicadores;(w=document.createElement("label")).innerHTML="es"===this.idioma?" Indicadores: ":"Indicators: ";c="";"v1_2"==API_V?(c=this.config._tematica&&""!=this.config._tematica?this.config._tematica:"null",d=C_direccionServicio_V+"_"+API_V.toLowerCase()+"/"):"v1_1"==API_V||(c=""!=this.config._tematica?this.config._tematica:"null",d=C_direccionServicio_V+"_"+API_V.toLowerCase()+"/");var m=this.urlApi()+"/BuscadorDescripcion",g=[];if("3"===this.config._tematica&&"v1_3"===API_V){var v,b,y=[],_=null,x=this.urlApi()+"/EquivalenciaIndicadorBIE_BISE",E={indicador:this.config._indicadores.join(","),formato:"json",token:this.token};$.ajax({url:x,method:"POST",data:JSON.stringify(E),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(t){if(v=t.filter(function(e){return"0"===e.TEMATICA}).map(function(e){return e.INDICADOR}),y=t.filter(function(e){return"3"===e.TEMATICA}).map(function(e){return e.INDICADOR}),v.length>0){var a={indicadores:v.join(","),idioma:i.idioma,formato:"json",tematica:0,token:i.token};b=$.ajax({url:m,type:"post",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e})}if(y.length>0){var n={indicadores:y.join(","),idioma:i.idioma,formato:"json",tematica:3,token:i.token};_=$.ajax({url:m,type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e})}$.when(b,_).done(function(t,a){g=[].concat(t||[],a||[]),i.tmpFunction(g,h,u,l,w,p,k,e)})})}else{E={indicadores:i.config._indicadores.join(","),idioma:i.idioma,formato:"json",tematica:c,token:i.token};$.ajax({url:m,method:"post",data:JSON.stringify(E),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(t){i.tmpFunction(t,h,u,l,w,p,k,e)}).fail(function(e){console.log(e)})}}}else if(0==$(document.getElementsByClassName("clsComboIndicadores_"+this.config.id)).children().length){var w,C=document.createElement("div");C.className="col-xs-12 col-sm-6 col-md-6 container-fluid cb-standar clsComboIndicadores_"+this.config.id,(w=document.createElement("label")).innerHTML="es"==this.idioma?" Indicador: ":" Indicator: ";var N=document.createElement("input");N.type="text",N.className="trunca form-control",N.setAttribute("disabled","disabled"),N.value=i.nombre_indicador,N.style.width="100%",$(C).append(w,N),$(e).find(".navbar").append(C)}if(this.config._areaGeografica.length>1){if(0==$(document.getElementsByClassName("clsComboAreasGeograficas_"+this.config.id)).children().length){var I=document.createElement("div");I.className="col-xs-12 col-sm-6  col-md-6 cb-standar clsComboAreasGeograficas_"+this.config.id;var A=document.createElement("div");A.className="dropdown";var k,S=document.createElement("button");S.type="button",S.className="btn btn-default dropdown-toggle col-xs-12 col-sm-12 col-md-12",S.setAttribute("data-toggle","dropdown"),S.setAttribute("aria-haspopup","false"),S.innerHTML="",S.id="_cbxAreasGeograficas"+this.config.id,S.style="text-align:left;",(k=document.createElement("span")).className="caret";var L=document.createElement("ul");L.className="dropdown-menu",L.style="max-height:500px;overflow:auto;width:100%";f=null;var T=this.config._areaGeografica,H=document.createElement("label");H.innerHTML="es"===this.idioma?" Área Geográfica: ":" Geographic Area: ",$.each(T,function(e,t){var a="";a="Estados Unidos Mexicanos"===t.nombre?t.nombre:t.nombre+" "+t.entidad;var n="";n=""!==t.entidad?'<span style=""><b>'+t.nombre+"</b> <br />("+t.entidad+")</div>":'<span style=""><b>'+t.nombre+"</b></div>";var o=document.createElement("label");o.style.width="100%";var r=document.createElement("div");-1!==i.config._orientacion.indexOf("Vertical")&&-1!==i.config._orientacion.indexOf("indicadorVertical")&&1===i.config._indicadores.length&&(r.style="display: inline-block;margin-right: 5px;width:15px;height:16px;background-color:"+i.colors[e]);var s=document.createElement("input"),c="checkbox";-1!==i.config._orientacion.indexOf("area")&&i.config._indicadores.length>=1?(s.type="checkbox",s.name="area_"+i.config.id,s.id=a,s.autocomplete="off",s.setAttribute("checked","checked")):(s.type="radio",s.name="area_"+i.config.id,s.id=a,s.value=a,0===e&&$(s).prop("checked",!0),c="radio"),s.className=s.className+" cls-input-graf",$(o).append(s,r,n),(f=document.createElement("li")).className=c,$(f).append(o),$(L).append(f),$(s).change(function(e){i.changedArea=!0,i._filtro_LlenaArrayFiltros()})});var O=document.createElement("span");O.className="textArea trunca",O.style.display="inline-block",O.style.width="100%",$(S).append(O,k),$(A).append(S,L),$(I).append(H,A),$(e).find(".navbar").append(I),0===i.areasSelected.length&&(i.config._indicadores.length>1&&i.config._areaGeografica.length>1&&(i.changedArea=!0),i._filtro_LlenaArrayFiltros())}$("#_cbxAreasGeograficas"+this.config.id).dropdown()}else if(0==$(document.getElementsByClassName("clsComboAreasGeograficas_"+this.config.id)).children().length){var j=document.createElement("div");j.className="col-xs-12 col-sm-6 col-md-6 container-fluid cb-standar clsComboAreasGeograficas_"+this.config.id;var B=document.createElement("label");B.innerHTML="es"===this.idioma?" Área Geográfica: ":" Geographic Area: ";var M=document.createElement("input");M.type="text",M.className="trunca form-control",M.style.width="100%",M.setAttribute("disabled","disabled"),M.value=i.config._areaGeografica[0].nombre,$(j).append(B,M),$(e).find(".navbar").append(j)}},this.tmpFunction=function(e,t,i,a,n,o,r,s){var c=this,d=c.arrIndicadoresLabel=e;$.each(d,function(e,t){var i=document.createElement("label");document.createElement("div").style="display: inline-block;margin-right: 5px;width:15px;height:16px;",0;var a=document.createElement("input"),n="checkbox";c.config._indicadores.length>=1&&c.config._areaGeografica.length>=1?(a.type="checkbox",a.setAttribute("checked","checked"),0===e&&(i.className=i.className+" active")):(a.type="radio",n="radio",0===e&&a.setAttribute("checked","checked")),a.name="indicador_"+c.config.id,a.id=t.indicador,a.autocomplete="off",a.setAttribute("data-value",t.indicador),a.setAttribute("data-value-name",t.nombre),a.className=a.className+" cls-input-graf";var r=t.nombre;$(i).append(a,r),liOpcionInd=document.createElement("li"),liOpcionInd.className=n,liOpcionInd.style.padding="0 24px",$(liOpcionInd).append(i),$(o).append(liOpcionInd),$(a).change(function(){c.changeIndicador=!0,c._filtro_LlenaArrayFiltros()})});var l=document.createElement("span");l.className="textIndicador trunca",l.style.display="inline-block",l.style.width="100%",$(i).append(l,r),$(a).append(i,o),$(t).append(n,a),$(s).find(".navbar").append(t),0===c.indicadoresSelected.length&&c._filtro_LlenaArrayFiltros()},this.renderFiltros=function(){document.getElementById(this.config.id);var e=document.getElementById(this.divToolbar);e&&(this._addComboPeriodos(e),this._addComboIndicadoresAreas(e))},this.addTools=function(){if(this.addHeaders(),this.config.hasOwnProperty("toolbar")&&this.config.toolbar){this.divToolbar="toolbar_"+this.config.id;var e=document.createElement("toolbar-graph");e.setAttribute("id",this.divToolbar);var t=document.createElement("nav");if(t.className="navbar navbar-default",t.style="padding-bottom:8px;z-index:999;",this.addButtonPrint(t),this.addLoadingTemplate(),e.appendChild(t),null===document.getElementById(this.config.id))throw" El contenedor "+this.config.id+" no existe.";document.getElementById(this.config.id).appendChild(e),$(".cls-tooltip").tooltip(),$(".cls-tooltip").dropdown()}},this.addHeaders=function(){var e=document.getElementById(this.config.id);if(this.config.hasOwnProperty("titulo")){var t=document.createElement("h3");t.innerHTML=this.config.titulo,(a=document.createElement("div")).className="row-fluid",a.className="text-center";var i=$(a).append(t);$(e).append(i)}if(this.config.hasOwnProperty("subtitulo")){var a,n=document.createElement("h4");n.innerHTML=this.config.subtitulo,(a=document.createElement("div")).className="row",a.className="text-center";i=$(a).append(n);$(e).append(i)}},this.addButtonsTools=function(e){var t=this,i=document.createElement("div");i.className="btn-group pull-right ",i.setAttribute("data-toggle","buttons");var a=document.createElement("div");a.className="container-fluid navbar-btn",a.id="btnTipoGrafica_"+this.config.id,[{text:"es"==t.idioma?"Barras verticales":"Vertical Bars",type:"column",icon:"inegi-grafcolumnas"},{text:"es"==t.idioma?"Barras horizontales":"Horizontal Bars",type:"bar",icon:"inegi-top"},{text:"es"==t.idioma?"Líneas":"Lines",type:"line",icon:"inegi-grafica-linea"},{text:"es"==t.idioma?"Áreas":"Areas",type:"area",icon:"inegi-grafarea"}].forEach(function(e,a){var n=document.createElement("label");n.className="btn btn-default","indicadorVertical"===t.config._orientacion&&(t.config.tipo="line"),t.config.tipo==e.type&&(n.className=n.className+" active"),n.title=e.text;var o=document.createElement("input");o.type="radio",o.name="tipografica_"+t.config.id,o.id=e.type;var r=document.createElement("i");r.setAttribute("data-toggle","tooltip"),r.setAttribute("data-placement","bottom"),r.className=e.icon,$(n).append(r,o),i.appendChild(n)}),a.appendChild(i),setTimeout(function(){$("input[name=tipografica_"+t.config.id+"]").change(function(e){var i=$(this).attr("id");t.change(i)})},1),e.appendChild(a)},this.addButtonsActions=function(e){var t=this,i=document.createElement("div");i.className="btn-group pull-right ",i.setAttribute("data-toggle","buttons"),[{icon:"inegi-grafica-linea",id:"g_etiqueta_btn",text:"es"==t.idioma?"Valores":"Values",tooltip:"es"==t.idioma?"Muestra / oculta valores de la gráfica":"Show / hide chart values",active:!0,listener:function(){t.etiquetas()}}].forEach(function(e,a){var n=document.createElement("button"),o=document.createElement("span");o.className=e.icon,o.style.paddingRight="6px",n.setAttribute("checked","checked"),n.checked=!0,n.type="checkbox",n.autocomplete="off",n.name="actionlabels_"+t.config.id,n.id=e.id,n.title=e.tooltip,n.setAttribute("data-placement","bottom"),$(n).append('<span style="font-size:11px">'+e.text+"</span>"),n.className="btn btn-default cls-graficador-tools",e.active&&(n.className=n.className+" active"),n.onclick=e.listener,$("#"+e.id).click(function(){$(this).button("toggle")}),document.createElement("i").className=e.icon,i.appendChild(n)}),$(e).children().append(i)},this.etiquetas=function(){var e=this.getInstance(),t=e.series.length;for(s=0;s<t;s++)e.series[s].update({dataLabels:{enabled:!this.enableDataLabels}});this.enableDataLabels=!this.enableDataLabels},this.addButtonPrint=function(e){var t=this,i=document.createElement("div");i.className="container-fluid navbar-btn",i.id="btnTipoGrafica_"+this.config.id;var a=document.createElement("div");a.className="btn-group pull-right ";var n=document.createElement("button");n.type="button",n.className="btn dropdown-toggle cls-tooltip cls-graficador-tools",n.setAttribute("data-toggle","dropdown"),n.setAttribute("aria-haspopup","true"),n.title="es"==t.idioma?"Opciones":"Options",n.setAttribute("data-placement","bottom"),n.style="text-align:left;";var o=document.createElement("span");o.className="inegi-menu",$(n).append(o);var r=document.createElement("ul");r.className="dropdown-menu";var s=null,c=document.createElement("div");c.className="btn-group col-md-12 col-s-12 col-xs-12",c.setAttribute("data-toggle","buttons"),c.style.padding=0,[{icon:"inegi-check",id:"btn_valores",text:"es"==t.idioma?"Mostrar valores":"Show values",tooltip:"es"==t.idioma?"Muestra / oculta valores de la gráfica":"Show / hide chart values",active:!0,listener:function(){t.etiquetas()}},{icon:"",id:"divider",text:"",tooltip:"",active:!0},{aButtonCharts:[{text:"es"==t.idioma?"Barras verticales":"Vertical Bars",type:"column",icon:"inegi-grafcolumnas"},{text:"es"==t.idioma?"Barras horizontales":"Horizontal Bars",type:"bar",icon:"inegi-top"},{text:"es"==t.idioma?"Líneas":"Lines",type:"line",icon:"inegi-grafica-linea"},{text:"es"==t.idioma?"Áreas":"Areas",type:"area",icon:"inegi-grafarea"}],text:"es"==t.idioma?"Gráficas":"Charts"},{icon:"",id:"divider2",text:"",tooltip:"",active:!0},{icon:"inegi-imprimir",text:"es"===t.idioma?"Imprimir":"Print",id:"btn_imprimir",listener:function(){t.imprimir()}},{icon:"inegi-descarga",path:C_dominio_seguro+"/img/ico/ico_PDF.png",text:"es"===t.idioma?"Exportar en PDF":"Save PDF",id:"btn_pdf",listener:function(){var e=document.getElementById("chartHiddenExport")?document.getElementById("chartHiddenExport"):document.createElement("div");e.id="chartHiddenExport",e.style.display="none",$("body").append(e);var i=Highcharts.chart("chartHiddenExport",t.chartConfigCurrent);i.update({title:{text:"Banco de indicadores"}}),i.exportChartLocal({type:"application/pdf",filename:"grafica_bie"}),$("#chartHiddenExport").remove()}},{icon:"inegi-descarga",path:C_dominio_seguro+"/img/ico/ico_PNG.png",text:"es"===t.idioma?"Exportar en PNG":"Save PNG",id:"btn_png",listener:function(){var e=document.getElementById("chartHiddenExport")?document.getElementById("chartHiddenExport"):document.createElement("div");e.id="chartHiddenExport",e.style.display="none",$("body").append(e);var i=Highcharts.chart("chartHiddenExport",t.chartConfigCurrent);i.update({title:{text:"Banco de indicadores"}}),i.exportChartLocal({type:"image/png",filename:"grafica_bie"}),$("#chartHiddenExport").remove()}}].forEach(function(e,i){if((s=document.createElement("li")).style.padding="0 10px","divider"===e.id||"divider2"===e.id)s.className="divider";else if("btn_valores"===e.id){var a=document.createElement("a");a.style.paddingLeft=0,a.style.paddingRight=0,a.href="javascript:void(0);",a.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),$($(this).children()[0]).is(":checked")?($($(this).children()[0]).prop("checked",!1),$($(this).children()[0]).val(!1)):($($(this).children()[0]).prop("checked",!0),$($(this).children()[0]).val(!0)),e.listener()});var n=document.createElement("input");n.type="checkbox",n.style.display="inline-block",n.setAttribute("checked",!0),(p=document.createElement("span")).innerHTML=e.text,p.style.paddingLeft="6px",$(a).append(n,p),$(s).append(a)}else if("btn_imprimir"===e.id){var o=document.createElement("a");o.href="javascript:void(0);",o.onclick=e.listener,o.style.display="inline-block",o.style.padding="0";var d=document.createElement("span");d.className=e.icon,d.style.display="inline-block",(p=document.createElement("span")).innerHTML=e.text,p.style.paddingLeft="6px",$(o).append(d,p),$(s).append(o)}else if("btn_pdf"===e.id||"btn_png"===e.id){var l=document.createElement("a");l.className="cls-tooltip",l.href="javascript:void(0);",l.style.display="inline-block",l.style.padding="0",l.onclick=e.listener;var h=document.createElement("img");h.src=e.path,l.setAttribute("data-original-title",e.text),l.setAttribute("data-toggle","tooltip"),l.setAttribute("data-placement","top"),$(l).append(h),$(s).append(l)}else{var p;e.aButtonCharts.forEach(function(e,i){var a=document.createElement("label");a.className="btn btn-default btn-xs","indicadorVertical"===t.config._orientacion&&(t.config.tipo="line"),t.config.tipo==e.type&&(a.className=a.className+" active"),a.setAttribute("data-toggle","tooltip"),a.setAttribute("data-placement","top"),a.setAttribute("data-original-title",e.text);var n=document.createElement("input");n.type="radio",n.name="tipografica_"+t.config.id,n.id=e.type;var o=document.createElement("i");o.className=e.icon,o.style.fontSize="13pt",$(a).append(o,n),c.appendChild(a)}),(p=document.createElement("span")).innerHTML=e.text,p.style.textAlign="center",p.style.display="block",$(s).css("display","inline-block"),$(s).append(p,c)}$(r).append(s)}),setTimeout(function(){$("input[name=tipografica_"+t.config.id+"]").change(function(e){var i=$(this).attr("id");t.change(i)})},1),$(a).append(n,r),$(i).append(a),$(e).append(i)},this.addButtonLegend=function(){var e=this,t=document.createElement("button");return t.className="btn btn-default",t.type="button",t.setAttribute("autocomplete","off"),t.setAttribute("data-toggle","button"),t.setAttribute("aria-pressed","false"),t.setAttribute("id","btnLegend_"+this.config.id),t.innerHTML="es"===this.idioma?"Leyenda":"Legend",t.addEventListener("click",function(){var t=e.getInstance(),i=!1;$(this).hasClass("active")||(i=!0),t.legend.update({enabled:i})}),t},this.urlApi=function(){if("v1_2"==API_V||"V1_3"==API_V)return C_direccionServicio_V+"_"+API_V.toLowerCase()+"/";var e=window.location.href.indexOf("http://internetpwww.inegi.org.mx/app/")>-1||window.location.href.indexOf("http://w-webinterpre1/app/")>-1?C_direccionServicioMan:C_direccionServicio,t="";return window.location.hostname.indexOf("en.")>-1?(this.idioma="en",(C_direccionServicio.indexOf("http://")>-1||C_direccionServicio.indexOf("https://")>-1)&&(e=(t=C_direccionServicio.split("://"))[0]+"://"+t[1])):e=C_direccionServicio,e},this.render=function(e){this.idioma=window.location.hostname.indexOf("en.")>-1?"en":"es",e.hasOwnProperty("id")?(this.config=e,"indicadorHorizontal"==this.config._orientacion&&this.config._indicadores.length>=1?(this.config._orientacion="indicadorVertical",console.warn("Modo indicadorHorizontal: varios indicadores, una area geografica")):this.config._indicadores.length>1&&this.config._areaGeografica.length>1&&"indicadorVertical"==this.config._orientacion?console.warn("Modo indicadorVertical: varios indicadores, varias areas geograficas"):"areaHorizontal"==this.config._orientacion&&this.config._areaGeografica>=1?console.warn("Modo areaVertical: un indicador, varias areas geograficas"):"areaVertical"==this.config._orientacion&&(this.config._orientacion="areaHorizontal",console.warn("Modo areaVertical: varios indicadores, varias areas geograficas")),this.addTools(),this.callService()):console.warn("> No se encontro el id del elemento html donde se dibujara")},this.renderNotasFuentes=function(e){var t=this;if(null!==this.datosNotasFuentes){this.divNotasFuentes.className="well-sm";var i=this.datosNotasFuentes;if(i.ErrorCode)return"es"===t.idioma?$(this.divNotasFuentes).append($('<div class="alert alert-warning" role="alert">No hay notas / fuentes para mostrar.</div>')):$(this.divNotasFuentes).append($('<div class="alert alert-warning" role="alert">There isn\'t notes / sources to show.</div>')),void this.loading(!1);var a=document.createElement("div");a.style="font-weight:bold;";var n=document.createElement("div");n.style="font-weight:bold;";var o=document.createElement("div");o.style="font-weight:bold;";var r=document.createElement("div");r.style="font-weight:bold;";var s=this.ul.cloneNode(!0),c=this.ul.cloneNode(!0),d=this.ul.cloneNode(!0),l=this.ul.cloneNode(!0);i.forEach(function(e,i){var h=document.createElement("li"),p=document.createElement("div");"NOTA"===e.tipo?(a.innerHTML="es"===t.idioma?"Notas":"Notes",p.innerHTML="<b>"+e.letra+"/</b> "+e.nota+" "+e.periodos+".",$(h).append(p),$(s).append(h)):"Cifras preliminares"==e.tipo?(n.innerHTML="Cifras Preliminares",p.innerHTML="<b>"+e.letra+"/</b> "+e.nota,$(h).append(p),$(c).append(h)):"Cifras revisadas"==e.tipo?(o.innerHTML="Cifras Revisadas",p.innerHTML="<b>"+e.letra+"/</b> "+e.nota,$(h).append(p),$(d).append(h)):(r.innerHTML="es"===t.idioma?"Fuentes":"Sources",p.innerHTML="<b>"+e.letra+"/</b> "+e.nota+" "+e.periodos+".",$(h).append(p),$(l).append(h))}),$(this.divNotasFuentes).children().remove(),$(this.divNotasFuentes).append(a,s,n,c,o,d,r,l)}else this.loading(!1)},this.change=function(e){this.selectionChart(e)},this.callService=function(){var e=this;this.config.tipo="indicadorVertical"==this.config._orientacion?"line":this.config.tipo,this.config.leyenda="indicadorVertical"==this.config._orientacion||this.config.leyenda;var t=this.config._indicadores,i=this.config._periodos,a=this.config._areaGeografica,n=this.config._orientacion;if(e.sinDatos=!1,t&&i&&a){var o=[],r=[];if($.each(a,function(e,t){o.push(t.id)}),this.areasSelected.length>0){var s=this.config._areaGeografica.map(function(t,i){var a=null,n="Estados Unidos Mexicanos"===t.nombre?t.nombre:t.nombre+" Estatal";return e.areasSelected.indexOf(n)>-1&&(a=t.id),a}).filter(function(e,t){return null!==e});s.length>0&&(o=s)}r=this.indicadoresIdSelected.length>0?this.indicadoresIdSelected.join(","):this.config._indicadores.join(",");var c="";-1!==this.config._orientacion.indexOf("Vertical")?(i.reverse(),this.periodosSelected.reverse(),c=0==this.periodosSelected.length?i.length>1?i[i.length-1]+"/"+i[0]:i[0]+"/"+i[0]:1==this.periodosSelected.length?this.periodosSelected[0]+"/"+this.periodosSelected[0]:this.periodosSelected[this.periodosSelected.length-1]+"/"+this.periodosSelected[0]):c=this.periodosSelected.length>0?this.periodosSelected[0]+"/"+this.periodosSelected[0]:0==i.length?"null":i[0]+"/"+i[0],this.loading(!0);var d="";if("v1_2"==API_V?d=""!=this.config._tematica&&null!=this.config._tematica?this.config._tematica+"/":"null/":"v1_1"==API_V||(d=""!=this.config._tematica&&null!=this.config._tematica?this.config._tematica+"/":"undefined/"),this.localhost){url_datos=this.urlApi()+"ExportacionBancoInformacion/"+r+"/"+o.join(",")+"/es/"+n+"/a/ap/"+c+"/false/false/"+d+"json/"+this.token;var l=$.ajax({url:url_datos,dataType:"json"}).then(function(e){return e})}else{url_datos=this.urlApi().replace("v1_1","v1_1")+"API.svc/ExportacionBancoInformacion";var h={areasGeograficas:o.join(","),casoExportacion:n,fechaFin:c.split("/")[1],fechaInicio:c.split("/")[0],formato:"json",idioma:this.idioma,indicadores:r,mostrarDecimales:"false",mostrarEstadistico:"false",ordenaPeriodo:"ap",orden:"a",tematica:d.replaceAll("/",""),token:e.token};l=$.ajax({url:url_datos,method:"post",data:JSON.stringify(h),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e})}var p=null;if(t.length>0){var u=c.split("/")[0],f=c.split("/")[1];if(r=t[0],e.config._areaGeografica.length>=31){h={idioma:e.idioma,indicador:r,areaGeografica:o.join(","),tematica:d.replaceAll("/",""),periodoinicial:u,periodofinal:f,mostrarGenerica:"1",formato:"json",token:e.token};p=$.ajax({url:e.urlApi()+"MetadatoIndicadorV2",method:"post",data:JSON.stringify(h),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e})}else{var m=e.urlApi().replace("v1_1","v1_1")+"MetadatoIndicador/"+this.idioma+"/"+r+"/"+o.join(",")+"/"+u+"/"+f+"/null/"+d+"json/"+e.token;p=$.ajax({url:m+"?callback=?",dataType:"json",method:"get"}).then(function(e){return e})}}var g=null;if(this.config._periodos.length>0||1==this.config._indicadores.length||this.indicadoresIdSelected.length>0){r=this.indicadoresIdSelected.length>0?this.indicadoresIdSelected.join(","):this.config._indicadores.join(","),u=c.split("/")[0],f=c.split("/")[1];if(this.localhost){var v=this.urlApi()+"NotasYFuentesExportacion/"+r+"/"+o.join(",")+"/es/"+u+"/"+f+"/"+d+"json/"+this.token;g=$.ajax({url:v+"?callback=?",dataType:"json"}).then(function(e){return e})}else{v=this.urlApi().replace("v1_1","v1_1")+"NotasYFuentesExportacion";var b={areasGeograficas:o.join(","),fechaInicio:u,fechaFin:f,formato:"json",idioma:this.idioma,indicadores:r,tematica:d.replaceAll("/",""),token:e.token};g=$.ajax({url:v,method:"POST",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",processData:!1,dataType:"json"}).then(function(e){return e})}}$.when(l,p,g).done(function(t,i,a){if(t.ErrorCode)e.sinDatos=!0;else{if(e.datosOriginales=t,e.datosMostrar=e.datosOriginales,null!==p){if(i.ErrorCode)return void $("#"+e.config.id).html(i.ErrorInfo);e.nombre_indicador=i.NOMBRE_INDICADOR}null!==g&&(e.datosNotasFuentes=a)}e.selectionChart(null!==e.tipo?e.tipo:e.config.tipo)})}else $("#"+this.config.id).html("Error: parametros faltantes para continuar. [indicadores, periodos, area_geografica]")},this.checkValue=function(e){return/\d/.test(e)?"0"===e?0:-1!==e.indexOf(",")?parseInt(e.split(",").join("")):(e.indexOf("-"),parseFloat(e)):null},this.getLastNameIndicador=function(e){var t="";if(-1!==e.indexOf(">")){var i=e.split(">");t=i[i.length-1].trim()}else t=e;return t},this.loading=function(e){var t="function"==typeof $().emulateTransitionEnd;e?t&&$("#loadingGraficador").modal({backdrop:"static",keyboard:!1}):($("#loadingGraficador").modal("hide"),$(".modal-backdrop").remove())},this.addLoadingTemplate=function(){if(this.config.id){var e=this.tplLoading;$("#"+this.config.id).append($(e))}},this.imprimir=function(){var e,t=document.getElementById("divGrafica_"+this.config.id),i=document.getElementById("divGraphicNotasFuentes_"+this.config.id),a=this.config.titulo||this.nombre_indicador,n=this.config.subtitulo||"",o=this.periodosSelected,r=this.nombre_indicador,s=this.config._areaGeografica,c=this.areasSelected,d="font-family:Helvetica;font-size:16px;";(e=document.getElementById("printBieGrafica"))||((e=document.createElement("iframe")).id="printBieGrafica",e.onload=function(){},e.style.visibility="hidden",e.style.height="0px",e.src="about:blank",e.width="100%",document.body.appendChild(e));if(e.contentWindow.document.open("text/htmlreplace"),""!==a){var l=document.createElement("div");l.innerHTML=a,l.style="width:100%;display:block;",e.contentWindow.document.write('<h3 style="font-family:Helvetica;font-size:25px;font-weight:bold;text-align:center;">'+l.innerHTML+"</h3>")}if(""!==n){var h=document.createElement("div");h.innerHTML=n,h.style="width:100%;display:block;",e.contentWindow.document.write('<h3 style="font-family:Helvetica;font-size:22px;text-align:center;">'+h.innerHTML+"</h3>")}if(""!==o){var p=o[0];if(o.length>1)var u=o[o.length-1];var f=document.createElement("div");f.innerHTML="<b>Periodos:</b> "+p+(null==u?"":" - "+u),f.style="width:100%;display:block;",e.contentWindow.document.write('<p style="'+d+'">'+f.innerHTML+"</p>")}var m=[],g="";s.length>1?s.forEach(function(e,t){c.forEach(function(t,i){-1!==t.indexOf(e.nombre)&&(g=e.nombre+" ("+e.entidad+")",m.push(g))})}):(g=-1!==s[0].nombre.indexOf("Estados Unidos")?s[0].nombre:s[0].nombre+" ("+s[0].entidad+")",m.push(g));var v=document.createElement("div");v.innerHTML="<b>Áreas Geográficas:</b> "+m.join(", "),v.style="width:100%;display:block;",e.contentWindow.document.write('<p style="'+d+'">'+v.innerHTML+"</p>");var b=document.createElement("div");b.innerHTML="<b>Indicador:</b> "+r,b.style="width:100%;display:block;",e.contentWindow.document.write('<p style="'+d+'">'+b.innerHTML+"</p>"),e.contentWindow.document.write(t.innerHTML),document.createElement("div").style="width:100%;display:block;",e.contentWindow.document.write(i.innerHTML),e.contentWindow.document.close(),e.contentWindow.print()}}
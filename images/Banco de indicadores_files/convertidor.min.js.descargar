var read, rutaMethodAPI_V2 = "", dominio = "localhost" === document.domain ? "http://desarrollowww.inegi.org.mx" : "", output = "", Convertidor = { readArchivo: function (n) { rutaMethodAPI_V2 = C_direccionServicio_V + "_" + API_V + "/API.svc/EquivalenciaIndicadorBIE_BISE", window.File && window.FileReader && window.FileList && window.Blob && (read = new FileReader, n.files && -1 < n.files[0].name.toLowerCase().indexOf(".iqy") ? (read.onload = function (e) { output = e.target.result, document.getElementById("txt_convertIQY").value = n.files[0].name }, read.readAsText(n.files[0])) : alert("es" === idiomaGlobal ? "El archivo no es compatible" : "The File are not fully supported in this browser.")) }, convertArchivo: function () { "" !== output ? Convertidor.trataParams(output) : alert("es" === idiomaGlobal ? "Selecciona un archivo para convertir." : "Select a file to convert") }, trataParams: function (e) { for (var n = e.split("&"), r = "", o = "", a = 0; a < n.length; a++)-1 !== n[a].indexOf("cveser") && (r = n[a].split("cveser=")[1].trim()), -1 !== n[a].indexOf("ag") && (o = n[a].split("ag=")[1].trim()); Convertidor.llamaAPIV2(n, r, o) }, llamaAPI: function (n, r, e) { e = "" === e ? "00" : e; e = Convertidor.postValores(n, r, e); $.ajax({ method: "POST", url: rutaMethodAPI, contentType: "application/json; charset=utf-8", dataType: "json", data: e, success: function (e) { e = Convertidor.callBack(e, n, r), e = Convertidor.unique(e); Convertidor.objetoExporta(e) }, error: function (e, n, r) { console.log(n, r) } }) }, postValores: function (e, n, r) { var o = n; "," === o.charAt(0) && (o = o.substring(1, o.length - 1)), "," === o.charAt(o.length - 1) && (o = o.substring(0, o.length - 2)); n = {}; return n.indicadores = o, n.areasGeograficas = r, n.temas = "null", n.formato = "json", n.token = "563cbaa8-58bb-fef8-6763-1f1dae318f99", JSON.stringify(n) }, llamaAPIV2: function (n, r, e) { e = "" === e ? "00" : e; e = Convertidor.postValoresV2(n, r, e); $.ajax({ method: "POST", url: rutaMethodAPI_V2, contentType: "application/json; charset=utf-8", dataType: "json", data: e, success: function (e) { void 0 === e.ErrorCode && 0 < e.length && (e = Convertidor.callBackV2(e, n, r), e = Convertidor.unique(e), Convertidor.objetoExporta(e)) }, error: function (e, n, r) { console.log(n, r) } }) }, postValoresV2: function (e, n, r) { var o = n; "," === o.charAt(0) && (o = o.substring(1, o.length - 1)), "," === o.charAt(o.length - 1) && (o = o.substring(0, o.length - 2)); n = {}; return n.indicador = o, n.formato = "json", n.token = "563cbaa8-58bb-fef8-6763-1f1dae318f99", JSON.stringify(n) }, callBack: function (e, n, r) { var o = "" === e.Indicador ? r : e.Indicador, a = "", i = []; if (-1 !== n[0].indexOf("exportacion")) for (var t = 0; t < n.length; t++)-1 !== n[t].indexOf("cveser") ? (a = -1 !== n[t].indexOf("exportacion") ? dominio + "/app/indicadores/exportacion.aspx?cveser=" + o : n[t].split("cveser=")[0] + "&cveser=" + o, i.push(a.replace("\n", ""))) : -1 !== n[t].indexOf("exportacion") ? i.push("exportacion.aspx?".replace("\n", "")) : -1 !== n[t].indexOf("iqy") ? i.push("FileFormat=iqyfile".replace("\n", "")) : i.push(n[t].replace("\n", "")); else { for (var s = 0; s < n.length; s++)-1 !== n[s].indexOf("aamin") ? (-1 !== n[s].indexOf("ConsultaExporta") && (a = dominio + "/app/indicadores/exportacion.aspx?aamin=" + n[s].split("aamin=")[1]), i.push(a.replace("\n", ""))) : -1 !== n[s].indexOf("ConsultaExporta") ? i.push("exportacion.aspx?".replace("\n", "")) : -1 !== n[s].indexOf("cveser") ? (a = "cveser=" + o, i.push(a.replace("\n", ""))) : -1 !== n[s].indexOf("iqy") ? i.push("FileFormat=iqyfile".replace("\n", "")) : i.push(n[s].replace("\n", "")); i.push("bie=true"), i.push("tematica=0") } return i }, callBackV2: function (e, n, r) { for (var o = [], a = 0; a < e.length; a++)o.push(e[a].INDICADOR); var i = o.join(","), t = "", s = []; if (-1 !== n[0].indexOf("exportacion")) { for (var c = 0; c < n.length; c++)-1 !== n[c].indexOf("cveser") ? (t = -1 !== n[c].indexOf("exportacion") ? dominio + "/app/indicadores/exportacion.aspx?cveser=" + i : n[c].split("cveser=")[0] + "&cveser=" + i, s.push(t.replace("\n", ""))) : -1 !== n[c].indexOf("exportacion") ? s.push("exportacion.aspx?".replace("\n", "")) : -1 !== n[c].indexOf("iqy") ? s.push("FileFormat=iqyfile".replace("\n", "")) : s.push(n[c].replace("\n", "")); s.push("cn=1") } else { for (var l = 0; l < n.length; l++)-1 !== n[l].indexOf("aamin") ? (-1 !== n[l].indexOf("ConsultaExporta") && (t = dominio + "/app/indicadores/exportacion.aspx?aamin=" + n[l].split("aamin=")[1]), s.push(t.replace("\n", ""))) : -1 !== n[l].indexOf("ConsultaExporta") ? s.push("exportacion.aspx?".replace("\n", "")) : -1 !== n[l].indexOf("cveser") ? (t = "cveser=" + i, s.push(t.replace("\n", ""))) : -1 !== n[l].indexOf("iqy") ? s.push("FileFormat=iqyfile".replace("\n", "")) : s.push(n[l].replace("\n", "")); s.push("bie=true"), s.push("tematica=0"), s.push("cn=1") } return s }, objetoExporta: function (e) { document.getElementById("ifIQY").src = e }, unique: function (e) { for (var n = "", r = [], o = 0; o < e.length; o++)for (var a = e[o].split("&"), i = 0; i < a.length; i++)arrinterno = a[i].split("=")[0], -1 === n.indexOf(arrinterno) && r.push(a[i]), n += "|" + arrinterno + "|"; return r.join("&").trim() } };